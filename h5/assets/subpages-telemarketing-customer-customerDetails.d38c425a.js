import{b5 as e,T as l,F as t,K as a,I as s,H as o,G as c,O as i,P as d,_ as n,M as u,L as r,N as f,af as k,aL as _,ar as y}from"./index.94028eaa.js";import{d as g,e as m,f as x,h as C,i as v}from"./index.b8622cd4.js";import{_ as h}from"./plugin-vue_export-helper.21dcd24c.js";var p=h({onLoad(e){console.log("初始化加载=>onLoad",e.id),this.orderId=e.id,this.getDetail()},data:()=>({tabType:"tel",layerType:"",dialogType:"",customerId:"",orderId:"",details:{},statistics:{callMin:"0",callMax:"0"},telList:[],telSelect:[{text:"正常",val:"1"},{text:"拒接",val:"2"},{text:"无人接听",val:"3"},{text:"停机/空号",val:"4"}],telSelectActive:"",wxSelect:[{text:"愿意",val:"1"},{text:"不愿意",val:"2"}],wxSelectActive:"",oemSelect:[{text:"近期有需求",val:"1"},{text:"长期有需求",val:"2"},{text:"无需求",val:"3"}],oemSelectActive:"",telRemark:""}),methods:{onTab(e){console.log("根据条件切换选项卡=>"),this.tabType=e},onCopy(t){console.log("复制手机号码=>",t),e({data:t,success:function(){console.log("已复制联系电话",t),l.showMsg("已复制联系电话")}})},onCloseLayer(){this.layerType=""},onPoint(e){console.log("onPoint customerId",e),this.layerType="tel",this.customerId=e},onCallTel(e,t){this.customerId=e,g({dxCustomerId:e,takeOrderId:this.orderId}).then((e=>{console.log("getCustomerCall=>rep",e),0==e.code&&(l.makePhoneCall(t),this.getDetail())}))},onTelSelect(e){this.telSelectActive=e},onWxSelect(e){this.wxSelectActive=e},onOemSelect(e){this.oemSelectActive=e},onSave(){console.log("弹出保存客户标注信息提示=>"),""!=this.telSelectActive?this.dialogType="saveok":l.showMsg("请选择电话情况")},onSaveClose(){this.dialogType=""},onSaveOk(){let e={takeOrderId:this.orderId,dxCustomerId:this.customerId,mobilePoint:this.telSelectActive,wxPoint:this.wxSelectActive,workPoint:this.oemSelectActive,callRemark:this.telRemark},l=this;console.log("onSaveOk params",e),m(e).then((e=>{console.log("getCustomerPoint=>rep",e),0==e.code&&(l.dialogType="",l.layerType="",l.getDetail())}))},onFinish(){console.log("弹出工单完成确认框=>"),this.dialogType="finish"},onFinishOk(){console.log("工单完成确认=>");let e=this;x({takeOrderId:e.orderId}).then((l=>{0==l.code&&(e.dialogType="",e.getDetail())}))},onGiveup(){console.log("弹出工单放弃确认框=>"),this.dialogType="giveup"},onGiveupOk(){console.log("工单放弃确认=>");let e=this;C({takeOrderId:e.orderId}).then((l=>{0==l.code&&(e.dialogType="",e.getDetail())}))},goChatHistory(e){console.log("跳转到沟通记录=>",e),l.navigateTo("chatHistory?act=customer&id="+e)},fmDateTime(e){console.log("seconds=>",e);var l=Math.floor(e/3600),t=Math.floor((e-3600*l)/60),a=e-3600*l-60*t,s="";return l>0&&(s+=l+" 小时 "),(t>0||l>0)&&(s+=t+" 分钟 "),(a>=0||0===l&&0===t)&&(s+=a+" 秒"),s.trim()},getDetail(){let e={takeOrderId:this.orderId};v(e).then((e=>{console.log("抢单客户详情=>rep",e),0==e.code&&(this.details=e.data.company,this.telList=e.data.mobileList,this.statistics.callMin=e.data.callCount.callMin,this.statistics.callMax=e.data.callCount.callMax)}))}}},[["render",function(e,l,g,m,x,C){const v=f,h=k,p=_;return t(),a(u,null,[s(v,{class:"page-customer"},{default:o((()=>[s(v,{class:"headtabs"},{default:o((()=>["tel"===x.tabType?(t(),c(v,{key:0,class:"li active"},{default:o((()=>[i("电话列表")])),_:1})):(t(),c(v,{key:1,class:"li",onClick:l[0]||(l[0]=e=>C.onTab("tel"))},{default:o((()=>[i("电话列表")])),_:1})),"crm"===x.tabType?(t(),c(v,{key:2,class:"li active"},{default:o((()=>[i("客户信息")])),_:1})):(t(),c(v,{key:3,class:"li",onClick:l[1]||(l[1]=e=>C.onTab("crm"))},{default:o((()=>[i("客户信息")])),_:1}))])),_:1}),"tel"===x.tabType?(t(),c(v,{key:0,class:"desc"},{default:o((()=>[s(h,{class:"text"},{default:o((()=>[i("拨打情况："+d(x.statistics.callMin)+"/"+d(x.statistics.callMax),1)])),_:1})])),_:1})):n("",!0),"tel"===x.tabType?(t(),c(v,{key:1,class:"datalist"},{default:o((()=>[(t(!0),a(u,null,r(x.telList,((e,l)=>(t(),c(v,{class:"li",key:l},{default:o((()=>["0"==e.callStatus?(t(),c(v,{key:0,class:"wait"},{default:o((()=>[i("待拨打")])),_:1})):n("",!0),"1"==e.callStatus?(t(),c(v,{key:1,class:"going"},{default:o((()=>[i("已拨打")])),_:1})):n("",!0),"2"==e.callStatus?(t(),c(v,{key:2,class:"marked"},{default:o((()=>[i("已标注")])),_:1})):(t(),c(v,{key:3,class:""})),s(v,{class:"name"},{default:o((()=>[i(d(e.dxCustomerName),1)])),_:2},1024),s(v,{class:"rows"},{default:o((()=>[s(v,{class:"text"},{default:o((()=>[i("电话")])),_:1}),s(v,{class:"val"},{default:o((()=>[i(d(e.dxCustomerMobile),1),s(h,{class:"btn-add",onClick:l=>C.onCopy(e.dxCustomerMobile)},{default:o((()=>[i("复制")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024),s(v,{class:"rows",style:{"margin-top":"20rpx"}},{default:o((()=>[s(v,{class:"text"},{default:o((()=>[i("标注结果")])),_:1}),s(v,{class:"val"},{default:o((()=>[e.mobilePoint?(t(),a(u,{key:0},["1"==e.mobilePoint?(t(),c(h,{key:0,class:"tag-green"},{default:o((()=>[i("正常")])),_:1})):n("",!0),"2"==e.mobilePoint?(t(),c(h,{key:1,class:"tag-blue"},{default:o((()=>[i("拒接")])),_:1})):n("",!0),"3"==e.mobilePoint?(t(),c(h,{key:2,class:"tag-blue"},{default:o((()=>[i("无人接听")])),_:1})):n("",!0),"4"==e.mobilePoint?(t(),c(h,{key:3,class:"tag-red"},{default:o((()=>[i("停机/空号")])),_:1})):n("",!0)],64)):n("",!0),e.wxPoint?(t(),a(u,{key:1},["1"==e.wxPoint?(t(),c(h,{key:0,class:"tag-green"},{default:o((()=>[i("愿意")])),_:1})):n("",!0),"2"==e.wxPoint?(t(),c(h,{key:1,class:"tag-red"},{default:o((()=>[i("不愿意")])),_:1})):n("",!0)],64)):n("",!0),e.workPoint?(t(),a(u,{key:2},["1"==e.workPoint?(t(),c(h,{key:0,class:"tag-green"},{default:o((()=>[i("近期有需求")])),_:1})):n("",!0),"2"==e.workPoint?(t(),c(h,{key:1,class:"tag-green"},{default:o((()=>[i("长期有需求")])),_:1})):n("",!0),"3"==e.workPoint?(t(),c(h,{key:2,class:"tag-blue"},{default:o((()=>[i("无需求")])),_:1})):n("",!0)],64)):(t(),c(h,{key:3},{default:o((()=>[i("-")])),_:1}))])),_:2},1024)])),_:2},1024),s(v,{class:"result"},{default:o((()=>[s(v,{class:"icon"},{default:o((()=>[s(v,{class:"text"}),"0"==e.callStatus?(t(),c(v,{key:0,class:"ico icon-tel",onClick:l=>C.onCallTel(e.dxCustomerId,e.dxCustomerMobile)},null,8,["onClick"])):n("",!0),"1"==e.callStatus?(t(),c(v,{key:1,class:"ico icon-mark",onClick:l=>C.onPoint(e.dxCustomerId)},null,8,["onClick"])):n("",!0),"2"==e.callStatus?(t(),c(v,{key:2,class:"ico"})):n("",!0),s(v,{class:"ico icon-history",onClick:l=>C.goChatHistory(e.dxCustomerId)},null,8,["onClick"])])),_:2},1024),s(v,{class:"info"},{default:o((()=>[s(v,{class:"text"}),"0"==e.callStatus?(t(),c(v,{key:0,class:"icon-text",onClick:l=>C.onCallTel(e.dxCustomerId,e.dxCustomerMobile)},{default:o((()=>[i("拨打电话 ")])),_:2},1032,["onClick"])):n("",!0),"1"==e.callStatus?(t(),c(v,{key:1,class:"icon-text",onClick:l=>C.onPoint(e.dxCustomerId)},{default:o((()=>[i("客户标注 ")])),_:2},1032,["onClick"])):n("",!0),"2"==e.callStatus?(t(),c(v,{key:2,class:"icon-text"})):n("",!0),s(v,{class:"icon-text",onClick:l=>C.goChatHistory(e.dxCustomerId)},{default:o((()=>[i("沟通记录")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})):n("",!0),"crm"===x.tabType?(t(),c(v,{key:2,class:"details"},{default:o((()=>[s(v,{class:"rows"},{default:o((()=>[s(v,{class:"text"},{default:o((()=>[i("客户")])),_:1}),s(v,{class:"val"},{default:o((()=>[i(d(x.details.username),1)])),_:1})])),_:1}),s(v,{class:"rows"},{default:o((()=>[s(v,{class:"text"},{default:o((()=>[i("公司")])),_:1}),s(v,{class:"val"},{default:o((()=>[i(d(x.details.name),1)])),_:1})])),_:1}),s(v,{class:"rows"},{default:o((()=>[s(v,{class:"text"},{default:o((()=>[i("地区")])),_:1}),s(v,{class:"val"},{default:o((()=>[i(d(x.details.addrDetail),1)])),_:1})])),_:1}),s(v,{class:"rows"},{default:o((()=>[s(v,{class:"text"},{default:o((()=>[i("规模")])),_:1}),s(v,{class:"val"},{default:o((()=>[i(d(x.details.scale),1)])),_:1})])),_:1})])),_:1})):n("",!0),s(v,{class:"order-finish"},{default:o((()=>[s(v,{class:"lt"},{default:o((()=>[s(v,{class:"giveup",onClick:l[2]||(l[2]=e=>C.onGiveup())},{default:o((()=>[i("放弃")])),_:1})])),_:1}),s(v,{class:"gt"},{default:o((()=>[s(v,{class:"btn-def",onClick:l[3]||(l[3]=e=>C.onFinish())},{default:o((()=>[i("工单完成")])),_:1})])),_:1})])),_:1}),"tel"==x.tabType&&"tel"==x.layerType?(t(),c(v,{key:3,class:"layer"},{default:o((()=>[s(v,{class:"windows"},{default:o((()=>[s(v,{class:"head"},{default:o((()=>[i(" 客户信息记录 "),s(v,{class:"close",onClick:l[4]||(l[4]=e=>C.onCloseLayer())})])),_:1}),s(v,{class:"form"},{default:o((()=>[s(v,{class:"text"},{default:o((()=>[i("电话情况")])),_:1}),s(v,{class:"row"},{default:o((()=>[(t(!0),a(u,null,r(x.telSelect,((e,l)=>(t(),c(v,{class:y(e.val==x.telSelectActive?"select active":"select"),key:l,onClick:l=>C.onTelSelect(e.val)},{default:o((()=>[i(d(e.text),1)])),_:2},1032,["class","onClick"])))),128))])),_:1}),"1"==x.telSelectActive?(t(),a(u,{key:0},[s(v,{class:"text"},{default:o((()=>[i("微信添加")])),_:1}),s(v,{class:"row"},{default:o((()=>[(t(!0),a(u,null,r(x.wxSelect,((e,l)=>(t(),c(v,{class:y(e.val==x.wxSelectActive?"select active":"select"),key:l,onClick:l=>C.onWxSelect(e.val)},{default:o((()=>[i(d(e.text),1)])),_:2},1032,["class","onClick"])))),128))])),_:1}),s(v,{class:"text"},{default:o((()=>[i("加工需求")])),_:1}),s(v,{class:"row"},{default:o((()=>[(t(!0),a(u,null,r(x.oemSelect,((e,l)=>(t(),c(v,{class:y(e.val==x.oemSelectActive?"select active":"select"),key:l,onClick:l=>C.onOemSelect(e.val)},{default:o((()=>[i(d(e.text),1)])),_:2},1032,["class","onClick"])))),128))])),_:1}),s(v,{class:"text"},{default:o((()=>[i("沟通记录")])),_:1}),s(v,{class:"row"},{default:o((()=>[s(p,{class:"textarea",placeholder:"请输入备注",modelValue:x.telRemark,"onUpdate:modelValue":l[5]||(l[5]=e=>x.telRemark=e)},null,8,["modelValue"])])),_:1})],64)):(t(),a(u,{key:1},[],64)),s(v,{class:"btn-def",onClick:l[6]||(l[6]=e=>C.onSave())},{default:o((()=>[i("保存")])),_:1})])),_:1})])),_:1})])),_:1})):n("",!0)])),_:1}),"finish"==x.dialogType?(t(),c(v,{key:0,class:"dialog"},{default:o((()=>[s(v,{class:"content"},{default:o((()=>[s(v,{class:"title"},{default:o((()=>[i("完成确认")])),_:1}),s(v,{class:"desc"},{default:o((()=>[i("提交工单完成，确认人员将对标注的内容进行确认，确定要提交吗？")])),_:1}),s(v,{class:"group"},{default:o((()=>[s(v,{class:"cancel",onClick:l[7]||(l[7]=e=>C.onSaveClose())},{default:o((()=>[i("取消")])),_:1}),s(v,{class:"ok",onClick:l[8]||(l[8]=e=>C.onFinishOk())},{default:o((()=>[i("确定")])),_:1})])),_:1})])),_:1})])),_:1})):n("",!0),"giveup"==x.dialogType?(t(),c(v,{key:1,class:"dialog"},{default:o((()=>[s(v,{class:"content"},{default:o((()=>[s(v,{class:"title"},{default:o((()=>[i("放弃确认")])),_:1}),s(v,{class:"desc"},{default:o((()=>[i("您已连续放弃x个客户，再进行放弃将冻结账号！确认放弃？")])),_:1}),s(v,{class:"group"},{default:o((()=>[s(v,{class:"cancel",onClick:l[9]||(l[9]=e=>C.onSaveClose())},{default:o((()=>[i("取消")])),_:1}),s(v,{class:"ok",onClick:l[10]||(l[10]=e=>C.onGiveupOk())},{default:o((()=>[i("确定")])),_:1})])),_:1})])),_:1})])),_:1})):n("",!0),"saveok"==x.dialogType?(t(),c(v,{key:2,class:"dialog"},{default:o((()=>[s(v,{class:"content"},{default:o((()=>[s(v,{class:"title"},{default:o((()=>[i("保存确认")])),_:1}),s(v,{class:"desc"},{default:o((()=>[i("确定保存吗？一旦保存将不可以修改！")])),_:1}),s(v,{class:"group"},{default:o((()=>[s(v,{class:"cancel",onClick:l[11]||(l[11]=e=>C.onSaveClose())},{default:o((()=>[i("取消")])),_:1}),s(v,{class:"ok",onClick:l[12]||(l[12]=e=>C.onSaveOk())},{default:o((()=>[i("确定")])),_:1})])),_:1})])),_:1})])),_:1})):n("",!0)],64)}],["__scopeId","data-v-19d30432"]]);export{p as default};
