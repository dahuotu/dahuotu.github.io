import{d as e,r as t,a,z as s,ad as l,b2 as r,T as i,ai as o,aB as c,at as n,F as u,K as m,I as d,H as p,J as f,G as g,M as h,L as A,_ as b,Z as y,O as k,aj as S,ap as C,aq as L,R,N as B,ac as I,S as v,ar as w,P as T}from"./index.94028eaa.js";import{_ as Y}from"./uni-search-bar.f5b39437.js";import{_ as E}from"./uni-segmented-control.6690164e.js";import{e as U,_ as H}from"./empty.9ee9749b.js";import{_ as K}from"./uni-icons.29799ac0.js";import{_ as N}from"./uni-datetime-picker.97ef656b.js";import{_ as P}from"./uni-popup.331ab2e7.js";import{G as D,a as F}from"./index.9d7f7591.js";import{c as _,_ as j,a as V}from"./icon-filter-off.9b14086c.js";import{_ as M,a as x}from"./icon-part-error.5c957f08.js";import{_ as X}from"./icon-part-success.14d4102f.js";import{_ as W}from"./plugin-vue_export-helper.21dcd24c.js";var q=W(e({name:"pickingAudit",components:{empty:U,checkItem:_},props:{},setup(e,u){S();const m=t(null),d=a({topHeight:"",searchParams:{taskLlNo:"",mouldNo:"",auditStatus:"",type:"",applyBy:"",startTime:"",endTime:"",pageNum:1,pageSize:10},labelList:{tabItem:["全部","待审核","已通过","已驳回"],tabCurrent:0},pickingAuditList:{list:[],total:0,moreStatus:"more",refresherStatus:!1,viewTop:0},filterSearch:{time:"",type:""},dataTypeList:[{label:"近一周",value:1},{label:"近一个月",value:2},{label:"近3个月",value:3}],typeList:[{label:"领料",value:1},{label:"退料",value:2}],range:[]});s((()=>{l().select(".top-content").boundingClientRect((function(e){d.topHeight=e.height})).exec()}));r((()=>d.filterSearch.time),(e=>{d.range=[]}));const p=async e=>{try{d.pickingAuditList.moreStatus="loading",d.searchParams=Object.assign(d.searchParams,e);const{pageNum:t,pageSize:a}=d.searchParams,{list:s,viewTop:l}=d.pickingAuditList,{success:r,massage:i,data:o}=await D(Object.assign(d.searchParams,e));r&&(f(Object.assign(d.searchParams,e)),Math.ceil(o.total/a)>=t?(1==t&&(d.pickingAuditList.viewTop=0),d.pickingAuditList={list:1==t?o.list:s.concat(o.list),total:o.total,moreStatus:"noMore",refresherStatus:!1}):d.pickingAuditList={moreStatus:"noMore",total:o.total,list:0==o.total?[]:s,refresherStatus:!1})}catch(t){throw new Error(t)}},f=async e=>{try{const{success:t,massage:a,data:s}=await F(e);if(t){const{allNum:e,num1:t,num2:a,num3:l}=s;d.labelList.tabItem=[`全部(${e})`,`待审核(${t})`,`已通过(${a})`,`已驳回(${l})`]}}catch(t){throw new Error(t)}};return p(),{Tool:i,BASE_IMAGE_URL:o,filter:m,moment:c,getPickingAudit:p,clearSearch:e=>{p({mouldNo:"",pageNum:1})},onClickItem:e=>{d.pickingAuditList.list=[];let t="";Number(e.currentIndex)>0&&(t=Number(e.currentIndex)),p({auditStatus:t,pageNum:1})},scrolltolower:e=>{const{pageNum:t,pageSize:a}=d.searchParams,{total:s}=d.pickingAuditList;let l=t,r=a,i=s;Math.ceil(i/r)>=l&&(l++,p({pageNum:l}))},onPulling:e=>{d.pickingAuditList.refresherStatus=!0},onRefresh:e=>{p({pageNum:1})},onRestore:e=>{},onAbort:e=>{},openFilter:e=>{m.value.open(e)},closeFilter:e=>{m.value.close()},filterChange:e=>{},searchFilter:e=>{const{time:t,type:a}=d.filterSearch;let s="",l="";switch(Number(t)){case 1:s=c().subtract(7,"days").format("YYYY-MM-DD"),l=c().format("YYYY-MM-DD");break;case 2:s=c().subtract(1,"months").format("YYYY-MM-DD"),l=c().format("YYYY-MM-DD");break;case 3:s=c().subtract(3,"months").format("YYYY-MM-DD"),l=c().format("YYYY-MM-DD")}d.range.length&&(s=d.range[0],l=d.range[1]),p({type:a,startTime:s,endTime:l}).then((e=>{m.value.close()}))},resetFilter:e=>{d.filterSearch={time:"",type:""},d.range=[],p({type:"",startTime:"",endTime:""}).then((e=>{m.value.close()}))},getPickingAuditStatistics:f,rangeChange:e=>{const{time:t,type:a}=d.filterSearch;e.length&&(d.filterSearch={time:"",type:a})},...n(d)}}}),[["render",function(e,t,a,s,l,r){const i=C(L("uni-search-bar"),Y),o=R,c=B,n=C(L("uni-segmented-control"),E),S=I("empty"),U=C(L("uni-load-more"),H),D=v,F=C(L("uni-icons"),K),_=I("checkItem"),W=C(L("uni-datetime-picker"),N),q=C(L("uni-popup"),P);return u(),m("div",{class:"main"},[d(c,{class:"top-content"},{default:p((()=>[d(c,{class:"search"},{default:p((()=>[f("div",{class:"search-left"},[d(i,{onConfirm:t[0]||(t[0]=t=>e.getPickingAudit({pageNum:1})),modelValue:e.searchParams.mouldNo,"onUpdate:modelValue":t[1]||(t[1]=t=>e.searchParams.mouldNo=t),onClear:e.clearSearch,bgColor:"#F5F5F5",cancelButton:"none",placeholder:"输入关联模具号"},null,8,["modelValue","onClear"])]),e.filterSearch.time||e.filterSearch.type||e.range.length?(u(),g(o,{key:0,src:j,onClick:t[2]||(t[2]=t=>e.openFilter("bottom")),alt:"",srcset:""})):(u(),g(o,{key:1,onClick:t[3]||(t[3]=t=>e.openFilter("bottom")),src:V,alt:"",srcset:""}))])),_:1}),d(c,{class:"tabs"},{default:p((()=>[d(n,{current:e.labelList.tabCurrent,values:e.labelList.tabItem,onClickItem:e.onClickItem,styleType:"text",activeColor:"#3A78F4 "},null,8,["current","values","onClickItem"])])),_:1}),d(c,{style:{height:"20rpx",background:"#f4f5f7"}})])),_:1}),d(D,{"scroll-y":"",class:"list",style:y("height:calc(100% - "+e.topHeight+"px)"),onScrolltolower:e.scrolltolower,"refresher-enabled":!0,"refresher-triggered":e.pickingAuditList.refresherStatus,"scroll-top":e.pickingAuditList.viewTop,onRefresherpulling:e.onPulling,onRefresherrefresh:e.onRefresh,onRefresherrestore:e.onRestore,onRefresherabort:e.onAbort},{default:p((()=>[(u(!0),m(h,null,A(e.pickingAuditList.list,((t,a)=>(u(),g(c,{class:"item",key:a,onClick:a=>e.Tool.navigateTo(`/pages/menus/warehouseManage/pickingAudit/pickingAuditDetails/index?taskLlId=${t.taskLlId}`)},{default:p((()=>[d(c,{class:"title-content"},{default:p((()=>[d(c,{class:w(["tips","领料"==t.actionTypeStr?"blue":"退料"==t.actionTypeStr?"red":""])},{default:p((()=>[k(T(t.actionTypeStr),1)])),_:2},1032,["class"]),d(c,{class:"title text-one-line"},{default:p((()=>[k(T(t.taskLlNo),1)])),_:2},1024)])),_:2},1024),d(c,{class:"order-content"},{default:p((()=>[d(c,{class:"row"},{default:p((()=>[d(c,{class:"label"},{default:p((()=>[k("关联模具号")])),_:1}),d(c,{class:"value"},{default:p((()=>[k(T(t.mouldNo),1)])),_:2},1024)])),_:2},1024),d(c,{class:"row"},{default:p((()=>[d(c,{class:"label"},{default:p((()=>[k("订单编号")])),_:1}),d(c,{class:"value"},{default:p((()=>[k(T(t.orderNo),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),d(c,{class:"info-content"},{default:p((()=>[t.createBy?(u(),g(o,{key:0,class:"icon-createBy",src:"data:image/png;base64,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",mode:"aspectFill"})):b("",!0),t.createBy?(u(),g(c,{key:1,class:"user"},{default:p((()=>[k(T(t.createBy),1)])),_:2},1024)):b("",!0),d(c,{class:"time"},{default:p((()=>[k(T(t.createTime)+"申请 ",1)])),_:2},1024)])),_:2},1024),1==t.auditStatus?(u(),g(c,{key:0,class:"status-content"},{default:p((()=>[d(o,{class:"icon-status",src:M,mode:"aspectFill"}),d(c,{class:"text blue"},{default:p((()=>[k("待审核")])),_:1})])),_:1})):b("",!0),2==t.auditStatus?(u(),g(c,{key:1,class:"status-content"},{default:p((()=>[d(o,{class:"icon-status",src:X,mode:"aspectFill"}),d(c,{class:"text green"},{default:p((()=>[k("已通过")])),_:1})])),_:1})):b("",!0),3==t.auditStatus?(u(),g(c,{key:2,class:"status-content"},{default:p((()=>[d(o,{class:"icon-status",src:x,mode:"aspectFill"}),d(c,{class:"text red"},{default:p((()=>[k("已驳回")])),_:1})])),_:1})):b("",!0)])),_:2},1032,["onClick"])))),128)),0==e.pickingAuditList.total?(u(),g(S,{key:0})):b("",!0),0!=e.pickingAuditList.total?(u(),g(U,{key:1,status:e.pickingAuditList.moreStatus},null,8,["status"])):b("",!0)])),_:1},8,["style","onScrolltolower","refresher-triggered","scroll-top","onRefresherpulling","onRefresherrefresh","onRefresherrestore","onRefresherabort"]),d(q,{ref:"filter","background-color":"#fff",onChange:e.filterChange},{default:p((()=>[d(c,{class:"popup-content"},{default:p((()=>[d(c,{class:"title"},{default:p((()=>[k("全部筛选")])),_:1}),d(F,{onClick:e.closeFilter,class:"icon-close",type:"closeempty",size:"28"},null,8,["onClick"]),d(D,{class:"pop-main"},{default:p((()=>[d(_,{class:"item",modelValue:e.filterSearch.type,"onUpdate:modelValue":t[4]||(t[4]=t=>e.filterSearch.type=t),list:e.typeList,title:"类型"},null,8,["modelValue","list"]),d(_,{class:"item",modelValue:e.filterSearch.time,"onUpdate:modelValue":t[5]||(t[5]=t=>e.filterSearch.time=t),list:e.dataTypeList,title:"申请时间"},null,8,["modelValue","list"]),d(W,{modelValue:e.range,"onUpdate:modelValue":t[6]||(t[6]=t=>e.range=t),type:"daterange",border:!1,"clear-icon":!1,onChange:e.rangeChange,"start-placeholder":"开始时间","end-placeholder":"结束时间"},null,8,["modelValue","onChange"])])),_:1}),d(c,{class:"btn-group"},{default:p((()=>[d(c,{class:"btn-reset",onClick:e.resetFilter},{default:p((()=>[k(" 重置")])),_:1},8,["onClick"]),d(c,{class:"btn-primary",onClick:e.searchFilter},{default:p((()=>[k(" 确定")])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1},8,["onChange"])])}],["__scopeId","data-v-c0624ccc"]]);export{q as default};
